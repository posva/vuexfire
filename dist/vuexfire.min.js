!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VuexFire=t():e.VuexFire=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){function i(e){return"function"==typeof e.key?e.key():e.key}function o(e){return"function"==typeof e.ref?e=e.ref():"object"==typeof e.ref&&(e=e.ref),e}function r(e){return"[object Object]"===Object.prototype.toString.call(e)}function u(e){var t=e.val(),n=r(t)?t:{".value":t};return n[".key"]=i(e),n}function s(e,t){for(var n=0;n<e.length;n++)if(e[n][".key"]===t)return n;return-1}function c(e,t,n){var i=!1,u=null,s=p.modules.getModuleFromKey(t),c=p.modules.getKey(t);if(r(n)&&n.hasOwnProperty("source")&&(i=n.asObject,u=n.cancelCallback,n=n.source),!r(n))throw new Error("VuexFire: invalid Firebase binding source.");if(!p.vuex.isKeyInState(e.$store.state,s,c))throw new Error('VuexFire: bind failed: "'+(s&&s+"/"||"")+c+'" is not defined in the store state');var d=o(n);e.$firebaseRefs[t]=d,e._firebaseSources[t]=n,i?f(e,t,s,c,n,u):a(e,t,s,c,n,u)}function a(e,t,n,o,r,c){var a=e.$store.state;p.vuex.initWithValue(a,n,o,[]);const f=r.on("child_added",function(t,i){const r=p.vuex.get(a,n,o),c=i?s(r,i)+1:0;e.$store.commit(p.vuex.getMutationName(n,v),{key:o,index:c,record:u(t)})},c),d=r.on("child_removed",function(t){const r=p.vuex.get(a,n,o),u=s(r,i(t));e.$store.commit(p.vuex.getMutationName(n,h),{key:o,index:u})},c),l=r.on("child_changed",function(t){const r=p.vuex.get(a,n,o),c=s(r,i(t));e.$store.commit(p.vuex.getMutationName(n,y),{key:o,index:c,record:u(t)})},c),m=r.on("child_moved",function(t,r){const c=p.vuex.get(a,n,o),f=s(c,i(t));var d=r?s(c,r)+1:0;d+=f<d?-1:0,e.$store.commit(p.vuex.getMutationName(n,g),{key:o,index:f,newIndex:d,record:u(t)})},c);e._firebaseListeners[t]={child_added:f,child_removed:d,child_changed:l,child_moved:m}}function f(e,t,n,i,o,r){const s=o.on("value",function(t){e.$store.commit(p.vuex.getMutationName(n,x),{key:i,record:u(t)})},r);e._firebaseListeners[t]={value:s}}function d(e,t){var n=p.modules.getModuleFromKey(t),i=e._firebaseSources&&e._firebaseSources[t];if(!i)throw new Error('VuexFire: unbind failed: "'+t+'" is not bound to a Firebase reference.');e.$store.commit(p.vuex.getMutationName(n,x),{key:t,record:null});const o=e._firebaseListeners[t];for(var r in o)i.off(r,o[r]);e.$firebaseRefs[t]=null,e._firebaseSources[t]=null,e._firebaseListeners[t]=null}function l(e){if(!e.$firebaseRefs){if(e.$firebaseRefs=Object.create(null),e._firebaseSources=Object.create(null),e._firebaseListeners=Object.create(null),!e.$store)throw new Error("VuexFire: missing Vuex. Install Vuex before VuexFire");e.$store.commit||(b(e.$store),e.$store.commit=e.$store.dispatch)}}function m(e){e.mixin($);const t=e.config.optionMergeStrategies;t.firebase=t.methods,e.prototype.$bindAsObject=function(e,t,n){l(this),c(this,e,{source:t,asObject:!0,cancelCallback:n})},e.prototype.$bindAsArray=function(e,t,n){l(this),c(this,e,{source:t,cancelCallback:n})},e.prototype.$unbind=function(e){d(this,e)}}function b(e){for(var t in m.mutations)e._mutations[t]=m.mutations[t]}var p=n(2);const x="VUEXFIRE/objectValue",y="VUEXFIRE/arrayChange",v="VUEXFIRE/arrayAdd",h="VUEXFIRE/arrayRemove",g="VUEXFIRE/arrayMove",$={beforeDestroy:function(){if(this.$firebaseRefs){for(var e in this.$firebaseRefs)this.$firebaseRefs[e]&&this.$unbind(e);this.$firebaseRefs=null,this._firebaseSources=null,this._firebaseListeners=null}},created:function(){var e=this.$options.firebase;if("function"==typeof e&&(e=e.call(this)),e){l(this);for(var t in e)c(this,t,e[t])}}};m.mutations={},m.mutations[x]=function(e,t){e[t.key]=t.record},m.mutations[y]=function(e,t){e[t.key].splice(t.index,1,t.record)},m.mutations[v]=function(e,t){e[t.key].splice(t.index,0,t.record)},m.mutations[h]=function(e,t){e[t.key].splice(t.index,1)},m.mutations[g]=function(e,t){const n=e[t.key];n.splice(t.newIndex,0,n.splice(t.index,1)[0])},m.moduleMutations=function(e){return Object.keys(m.mutations).reduce(function(t,n){return t[e.replace(".","/")+"/"+n]=m.mutations[n],t},{})},e.exports=m,"undefined"!=typeof window&&window.Vue&&m(window.Vue)},function(e,t,n){t.modules=n(3),t.vuex=n(4)},function(e,t){t.getModuleFromKey=function(e){var t=e.split(".");return t.slice(0,t.length-1).reduce(function(e,t){return e?e+"/"+t:t},"")},t.getKey=function(e){var t=e.split(".");return t[t.length-1]||""}},function(e,t){function n(e,t){return t.reduce(function(e,t){return e[t]},e)}t.isKeyInState=function(e,t,i){return void 0!==(t?n(e,t.split("/"))[i]:e[i])},t.initWithValue=function(e,t,i,o){t?n(e,t.split("/"))[i]=o:e[i]=o},t.get=function(e,t,i){return t?n(e,t.split("/"))[i]:e[i]},t.getMutationName=function(e,t){return e?e+"/"+t:t}}])});